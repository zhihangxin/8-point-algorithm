(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     33383,        815]
NotebookOptionsPosition[     31472,        784]
NotebookOutlinePosition[     31895,        801]
CellTagsIndexPosition[     31852,        798]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"uvMat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2120", ",", "2381", ",", "2182", ",", "1807"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2523", ",", "2337", ",", "2601", ",", "1800"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2454", ",", "1203", ",", "2445", ",", "548"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1937", ",", "150", ",", "1744", ",", "204"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"878", ",", "503", ",", "591", ",", "367"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"878", ",", "1089", ",", "704", ",", "999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"595", ",", "1555", ",", "453", ",", "1932"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"97", ",", "2368", ",", "53", ",", "2740"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.502252690671875*^9, 3.50225269165625*^9}, 
   3.502252730640625*^9, {3.8003577212218127`*^9, 3.800357927438177*^9}, {
   3.8003601857732296`*^9, 3.8003603461322665`*^9}, {3.800362147405419*^9, 
   3.8003623349658694`*^9}, {3.800404884373833*^9, 3.8004050262675905`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"9f21d38f-5529-447c-8681-c366e2f7ad86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eightpoint", "[", "uvmat_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"mat", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "9"}], "}"}]}], "]"}]}], ",", "mattmat", ",", 
      "fvec", ",", 
      RowBox[{"fmat", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"fsubmat", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"hmat", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ",", "e1vec", ",", 
      "e2vec"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "F\:3092\:3068\:3082\:3081\:308b", " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", "8"}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", 
         RowBox[{"uvmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "4"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "5"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"uvmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "6"}], "]"}], "]"}], "=", 
         RowBox[{"uvmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "7"}], "]"}], "]"}], "=", 
         RowBox[{"uvmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "8"}], "]"}], "]"}], "=", 
         RowBox[{"uvmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "9"}], "]"}], "]"}], "=", "1.0"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mattmat", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "mat", "]"}], ".", "mat"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eigenveclist", "=", 
      RowBox[{"Eigenvectors", "[", "mattmat", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fvec", "=", 
      RowBox[{"eigenveclist", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", 
      RowBox[{"fvec", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<F=\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "fmat", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "H\:3092\:3068\:3082\:3081\:308b", " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"fmat", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"fmat", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hmat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"fmat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<H=\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "hmat", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "e\:3092\:6c42\:3081\:308b", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"eigenveclist", "=", 
      RowBox[{"Eigenvectors", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "fmat", "]"}], ".", "fmat"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fvec", "=", 
      RowBox[{"eigenveclist", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e1vec", "=", 
      RowBox[{"fvec", "/", 
       RowBox[{"fvec", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<e1=\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "e1vec", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"eigenveclist", "=", 
      RowBox[{"Eigenvectors", "[", 
       RowBox[{"fmat", ".", 
        RowBox[{"Transpose", "[", "fmat", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fvec", "=", 
      RowBox[{"eigenveclist", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e2vec", "=", 
      RowBox[{"fvec", "/", 
       RowBox[{"fvec", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<e2=\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "e2vec", "]"}], ";", "\[IndentingNewLine]", 
     "fmat"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"b126e661-394c-45b9-b877-594f83263c03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "\:76f4\:7dda\:306e\:30d1\:30e9\:30e1", "-", 
     "\:30bf\:3068\:753b\:50cf\:30b5\:30a4\:30ba\:304b\:3089"}], ",", 
    "\:76f4\:7dda\:306e\:7aef\:70b9\:3092\:6c42\:3081\:308b\:95a2\:6570"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"drawline", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "width_", ",", "height_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"linevertex", "=", 
        RowBox[{"{", "}"}]}], ",", "y0", ",", "y1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"b", "==", "0"}], " ", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"0", "\[LessEqual]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "c"}], "/", "a"}], ")"}]}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "c"}], "/", "a"}], ")"}], "\[LessEqual]", 
            RowBox[{"width", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"linevertex", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "c"}], "/", "a"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "c"}], "/", "a"}], ",", 
               RowBox[{"height", "-", "1"}]}], "}"}]}], "}"}]}]}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"a", "\[Equal]", "0"}], " ", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"0", "\[LessEqual]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "c"}], "/", "b"}], ")"}]}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "c"}], "/", "b"}], ")"}], "\[LessEqual]", 
            RowBox[{"height", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"linevertex", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "c"}], "/", "b"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"width", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "c"}], "/", "b"}]}], "}"}]}], "}"}]}]}], "]"}], 
        ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x0", "=", 
          RowBox[{
           RowBox[{"-", "c"}], "/", "a"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c"}], "-", 
             RowBox[{"b", 
              RowBox[{"(", 
               RowBox[{"height", "-", "1"}], ")"}]}]}], ")"}], "/", "a"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"y0", "=", 
          RowBox[{
           RowBox[{"-", "c"}], "/", "b"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"y1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c"}], "-", 
             RowBox[{"a", 
              RowBox[{"(", 
               RowBox[{"width", "-", "1"}], ")"}]}]}], ")"}], "/", "b"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"y0", "<", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"0", "\[LessEqual]", "x0"}], "&&", 
              RowBox[{"x0", "\[LessEqual]", 
               RowBox[{"width", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"linevertex", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"linevertex", ",", 
                RowBox[{"{", 
                 RowBox[{"x0", ",", "0"}], "}"}]}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"height", "-", "1"}], "<", "y0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"0", "\[LessEqual]", "x1"}], "&&", 
              RowBox[{"x1", "\[LessEqual]", 
               RowBox[{"width", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"linevertex", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"linevertex", ",", 
                RowBox[{"{", 
                 RowBox[{"x1", ",", 
                  RowBox[{"height", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], 
           ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
           RowBox[{"linevertex", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"linevertex", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "y0"}], "}"}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"y1", "<", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"0", "\[LessEqual]", "x0"}], "&&", 
              RowBox[{"x0", "\[LessEqual]", 
               RowBox[{"width", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"linevertex", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"linevertex", ",", 
                RowBox[{"{", 
                 RowBox[{"x0", ",", "0"}], "}"}]}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"height", "-", "1"}], "<", "y1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"0", "\[LessEqual]", "x1"}], "&&", 
              RowBox[{"x1", "\[LessEqual]", 
               RowBox[{"width", "-", "1"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"linevertex", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"linevertex", ",", 
                RowBox[{"{", 
                 RowBox[{"x1", ",", 
                  RowBox[{"height", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], 
           ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
           RowBox[{"linevertex", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"linevertex", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"width", "-", "1"}], ",", "y1"}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"width", ",", " ", "\"\< \>\"", ",", "height"}], "]"}], ";", 
      "\[IndentingNewLine]", "linevertex"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.502250606453125*^9, 3.5022506221875*^9}, {
  3.5022506656875*^9, 3.502250683765625*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"c50f1c8a-88b5-4694-ae57-9d71662e3924"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "\:76f4\:7dda\:306e\:30d1\:30e9\:30e1", "-", 
     "\:30bf\:3068\:753b\:50cf\:3092\:53d7\:3051\:53d6\:3063\:3066"}], ",", 
    "\:76f4\:7dda\:3092\:5f15\:304f"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"drawlineonimage", "[", 
    RowBox[{"lineparam_", ",", "image_", ",", " ", "imagesize_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "linevertex", ",", "imagelist", ",", "imageraster", ",", 
       "rasterdimensions", ",", "width", ",", "height"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"imagelist", "=", 
        RowBox[{"image", "/.", 
         RowBox[{"Graphics", "\[Rule]", "List"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"imageraster", "=", 
        RowBox[{"imagelist", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"width", "=", 
       RowBox[{"imagesize", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"height", "=", 
       RowBox[{"imagesize", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "imagesize", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"linevertex", "=", 
       RowBox[{"drawline", "[", 
        RowBox[{
         RowBox[{"lineparam", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"lineparam", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"lineparam", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "width", ",", "height"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "linevertex", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"linevertex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"linez", " ", "=", " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"linevertex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"height", "-", "1", "-", 
                RowBox[{
                 RowBox[{"linevertex", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"linevertex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"height", "-", "1", "-", 
                RowBox[{
                 RowBox[{"linevertex", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"linez", ",", "image"}], "]"}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"image", ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"linevertex", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"height", "-", "1", "-", 
                  RowBox[{
                   RowBox[{"linevertex", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"linevertex", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"height", "-", "1", "-", 
                  RowBox[{
                   RowBox[{"linevertex", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], "]"}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", "image", "]"}], ",", "linez"}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5021703484375*^9, 3.50217042953125*^9}, {
   3.502170803265625*^9, 3.5021708101875*^9}, {3.502170978515625*^9, 
   3.502171002921875*^9}, {3.5021714806875*^9, 3.50217148521875*^9}, {
   3.5021725958125*^9, 3.502172596734375*^9}, {3.50217280315625*^9, 
   3.502172875484375*^9}, {3.5021729236875*^9, 3.502172952328125*^9}, {
   3.502173103984375*^9, 3.50217313621875*^9}, {3.50217318309375*^9, 
   3.502173227203125*^9}, {3.502173352546875*^9, 3.502173359890625*^9}, {
   3.502173504125*^9, 3.502173507390625*^9}, {3.502173592296875*^9, 
   3.502173592625*^9}, {3.502173732984375*^9, 3.50217373403125*^9}, {
   3.502173884453125*^9, 3.50217390978125*^9}, {3.502174082265625*^9, 
   3.50217408303125*^9}, {3.502246963921875*^9, 3.50224697159375*^9}, {
   3.502247002078125*^9, 3.502247015296875*^9}, {3.5022470468125*^9, 
   3.502247047875*^9}, {3.502247092078125*^9, 3.50224727553125*^9}, {
   3.502247306078125*^9, 3.50224735525*^9}, {3.502247582953125*^9, 
   3.50224762090625*^9}, {3.502247690859375*^9, 3.502247776921875*^9}, {
   3.502247808140625*^9, 3.502247884171875*^9}, {3.50224791525*^9, 
   3.50224792771875*^9}, {3.5022479703125*^9, 3.502248033078125*^9}, {
   3.502248066390625*^9, 3.50224809009375*^9}, {3.502248138*^9, 
   3.5022481460625*^9}, 3.502248251578125*^9, 3.502248298078125*^9, {
   3.502248335015625*^9, 3.502248345796875*^9}, {3.502248403578125*^9, 
   3.5022484106875*^9}, {3.502248466609375*^9, 3.502248587765625*^9}, 
   3.50225054721875*^9, {3.502250629328125*^9, 3.502250631765625*^9}, {
   3.502250916984375*^9, 3.5022509525625*^9}, {3.50225103996875*^9, 
   3.50225109275*^9}, {3.502251187953125*^9, 3.502251200609375*^9}, {
   3.502251876515625*^9, 3.502251916296875*^9}, {3.502251961140625*^9, 
   3.502251965546875*^9}, {3.50225222446875*^9, 3.5022522343125*^9}, {
   3.502252428*^9, 3.5022524354375*^9}, {3.502253702953125*^9, 
   3.5022537365625*^9}, {3.50225385771875*^9, 3.50225385903125*^9}, {
   3.50225389821875*^9, 3.5022539150625*^9}, {3.50225396715625*^9, 
   3.502253969828125*^9}, {3.502254068484375*^9, 3.50225409821875*^9}, {
   3.502254179859375*^9, 3.50225420703125*^9}, {3.50225431078125*^9, 
   3.5022544253125*^9}, {3.502255009296875*^9, 3.502255020375*^9}, {
   3.800362801806588*^9, 3.8003628323963785`*^9}, {3.800362897908415*^9, 
   3.800362900612291*^9}, {3.800363500611412*^9, 3.8003635064438944`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"efb5a206-1203-402f-a08d-b54d41a0f002"],

Cell[BoxData[
 RowBox[{"fMat", "=", 
  RowBox[{"eightpoint", "[", "uvMat", "]"}]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"b66de141-6b7a-4d44-b1ed-1d109aa33de9"],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "fMat", "]"}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"e3dec143-f614-482f-9ae6-f9349705bda9"],

Cell[BoxData[
 RowBox[{"line1", "=", 
  RowBox[{"fMat", ".", 
   RowBox[{"{", 
    RowBox[{"502", ",", "548", ",", "1"}], "}"}]}]}]], "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"c7ca9510-9003-498c-b85c-de509f1b4202"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1262", ",", "112", ",", "1"}], "}"}], ".", "fMat", ".", 
  RowBox[{"{", 
   RowBox[{"1131", ",", "7", ",", "1"}], "}"}]}]], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"0f7148cc-301f-4c38-a6b4-a5ffdf3d5000"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"739", ",", "659", ",", "1"}], "}"}], ".", "fMat", ".", 
  RowBox[{"{", 
   RowBox[{"601", ",", "579", ",", "1"}], "}"}]}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"1fa692c9-fae8-48d4-84c0-449e2a996895"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"763", ",", "622", ",", "1"}], "}"}], ".", "fMat", ".", 
  RowBox[{"{", 
   RowBox[{"601", ",", "579", ",", "1"}], "}"}]}]], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"363b3ac0-0108-44e8-be3a-af8ad1416871"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"imagelist1", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<C:\\\\aaa.JPG\>\"", ",", "\"\<Graphics\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.502170457859375*^9, 3.50217046015625*^9}, {
   3.502252994*^9, 3.502252998140625*^9}, {3.50225317596875*^9, 
   3.502253184828125*^9}, {3.8003583496203156`*^9, 3.8003583499973316`*^9}, 
   3.80040282427714*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"feb8ddd5-7c1c-40fb-8e1e-a6738e0c53c3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"imagelist2", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<C:\\\\bbb.JPG\>\"", ",", "\"\<Graphics\>\""}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"imagesize2", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<C:\\\\bbb.JPG\>\"", ",", "\"\<ImageSize\>\""}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", " ", "[", "imagesize2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.502170466203125*^9, 3.50217046753125*^9}, {
  3.502170501984375*^9, 3.5021705099375*^9}, {3.50217064353125*^9, 
  3.502170718359375*^9}, {3.502170761*^9, 3.50217076134375*^9}, {
  3.50217112546875*^9, 3.50217115246875*^9}, {3.50217406809375*^9, 
  3.502174069328125*^9}, {3.502252969*^9, 3.50225298425*^9}, {
  3.502253190921875*^9, 3.502253200078125*^9}, {3.800358352877026*^9, 
  3.800358362317092*^9}, {3.8004028311250196`*^9, 3.8004028370217505`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"103832a1-19d0-4bda-9c8f-9917e075c135"],

Cell[BoxData[
 RowBox[{"point1", " ", "=", 
  RowBox[{"{", 
   RowBox[{"875", ",", "1088"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.502253297*^9, 3.50225331490625*^9}, {
  3.50225511621875*^9, 3.50225512259375*^9}, {3.8003586370381684`*^9, 
  3.8003586419410577`*^9}, {3.800359082757908*^9, 3.800359087420235*^9}, {
  3.8003594020142126`*^9, 3.8003594065802445`*^9}, {3.80035975339018*^9, 
  3.8003597603158464`*^9}, {3.8003606234879103`*^9, 3.800360629442301*^9}, {
  3.8003616878949986`*^9, 3.8003616885472546`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"ef4440f6-a4a1-42bf-aa4c-5400b1ec4f06"],

Cell[BoxData[
 RowBox[{"lineparam", "=", 
  RowBox[{"fMat", ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"point1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"point1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.502253293875*^9, 3.50225333471875*^9}, {
  3.502253390859375*^9, 3.502253440203125*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"920dd87e-dfd6-4ad1-a92e-846e77704d5a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"drawlineonimage", "[", 
   RowBox[{"lineparam", ",", "imagelist2", ",", "imagesize2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.50217047575*^9, 3.502170489296875*^9}, {
   3.502171625828125*^9, 3.50217162690625*^9}, {3.502172554734375*^9, 
   3.50217257025*^9}, 3.5022518671875*^9, {3.502253208046875*^9, 
   3.502253209953125*^9}, 3.800402850333617*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"a4b6eb19-6a22-48db-8d70-085fd2b17464"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8003628570745525`*^9, 3.800362857081379*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"6e8c5ced-a2c4-4002-9ac7-1d799ca94723"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", "imagelist1", "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"point1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"point1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.50225324665625*^9, 3.5022532805625*^9}, {
  3.50225345603125*^9, 3.502253504796875*^9}, {3.502254475890625*^9, 
  3.5022544989375*^9}, {3.502254580796875*^9, 3.502254582375*^9}, {
  3.502254616171875*^9, 3.502254618578125*^9}, {3.80035844200678*^9, 
  3.8003585333274145`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"5dd347c8-3d47-473b-a8b8-d86cd015bd32"]
},
WindowSize->{1440., 748.5},
WindowMargins->{{-4.875, Automatic}, {Automatic, -4.875}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (2020\:5e744\:67088\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d704fb5f-ada7-43fd-b614-0ecb9e665bb2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1184, 25, 48, "Input",ExpressionUUID->"9f21d38f-5529-447c-8681-c366e2f7ad86"],
Cell[1732, 47, 9517, 257, 1202, "Input",ExpressionUUID->"b126e661-394c-45b9-b877-594f83263c03"],
Cell[11252, 306, 7273, 180, 1010, "Input",ExpressionUUID->"c50f1c8a-88b5-4694-ae57-9d71662e3924"],
Cell[18528, 488, 7479, 159, 490, "Input",ExpressionUUID->"efb5a206-1203-402f-a08d-b54d41a0f002"],
Cell[26010, 649, 172, 3, 28, "Input",ExpressionUUID->"b66de141-6b7a-4d44-b1ed-1d109aa33de9"],
Cell[26185, 654, 146, 2, 43, "Input",ExpressionUUID->"e3dec143-f614-482f-9ae6-f9349705bda9"],
Cell[26334, 658, 221, 5, 28, "Input",ExpressionUUID->"c7ca9510-9003-498c-b85c-de509f1b4202"],
Cell[26558, 665, 263, 6, 28, "Input",ExpressionUUID->"0f7148cc-301f-4c38-a6b4-a5ffdf3d5000"],
Cell[26824, 673, 263, 6, 28, "Input",ExpressionUUID->"1fa692c9-fae8-48d4-84c0-449e2a996895"],
Cell[27090, 681, 263, 6, 28, "Input",ExpressionUUID->"363b3ac0-0108-44e8-be3a-af8ad1416871"],
Cell[27356, 689, 515, 10, 62, "Input",ExpressionUUID->"feb8ddd5-7c1c-40fb-8e1e-a6738e0c53c3"],
Cell[27874, 701, 1022, 19, 134, "Input",ExpressionUUID->"103832a1-19d0-4bda-9c8f-9917e075c135"],
Cell[28899, 722, 599, 10, 28, "Input",ExpressionUUID->"ef4440f6-a4a1-42bf-aa4c-5400b1ec4f06"],
Cell[29501, 734, 458, 11, 28, "Input",ExpressionUUID->"920dd87e-dfd6-4ad1-a92e-846e77704d5a"],
Cell[29962, 747, 496, 9, 48, "Input",ExpressionUUID->"a4b6eb19-6a22-48db-8d70-085fd2b17464"],
Cell[30461, 758, 173, 2, 28, "Input",ExpressionUUID->"6e8c5ced-a2c4-4002-9ac7-1d799ca94723"],
Cell[30637, 762, 831, 20, 43, "Input",ExpressionUUID->"5dd347c8-3d47-473b-a8b8-d86cd015bd32"]
}
]
*)

